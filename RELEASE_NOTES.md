# Release Notes — react-oms-wireframe

배포 날짜: 2025-09-14
브랜치: `main`

## 개요
이번 릴리스는 분류 편집(Product Classifications) 및 쇼핑몰 카테고리 매핑(Category Mapping) UX 개선에 중점을 뒀습니다. 핵심 목표는 편집 흐름 완성도 향상, 계층형 선택기(HierarchicalSelect)의 사용성 개선(포탈 + 가로 컬럼), 모달 크기 조정, 그리고 분류 트리의 접기/펼치기 애니메이션을 보다 자연스럽게 만드는 것입니다.

이번 릴리스에서 변경되거나 추가된 주요 사항과 배포/QA 체크리스트를 아래에 상세히 정리합니다.

---

## 핵심 변경 사항 (하이라이트)

- Product Classifications (분류 편집)
  - 삭제 미리보기 모달 추가: 하위 노드를 함께 삭제하는 경우 영향을 미치는 항목을 미리 보여주고 확인을 요구합니다.
  - 모달 크기 조절: 루트 추가, 자식 추가, 편집 등 액션별로 적절한 모달 최대 너비(`max-w-...`)를 적용했습니다.
  - 접기/펼치기 애니메이션 개선: `AnimatedCollapse`를 도입하여 자식 목록의 높이를 측정한 뒤 `max-height` 전환을 사용해 부드럽게 애니메이션됩니다.
  - 노드 선택 및 편집 흐름 개선: 노드 선택 시 하이라이트, 액션 버튼에서 이벤트 전파 차단(e.stopPropagation) 적용.
  - 변경사항 저장/불러오기: 분류 트리를 `localStorage`에 저장/로드하도록 유지합니다 (`productClassificationsTree` 키).

- HierarchicalSelect (공통 컴포넌트)
  - 포탈화: 드롭다운 패널을 `document.body`로 포탈하여 모달/오버플로우 문제를 해결했습니다.
  - 내부 레이아웃: 계층(Depth)을 가로 방향의 고정-width 컬럼으로 렌더링하여 2뎁스 이상 메뉴 선택성을 개선했습니다 (컬럼 너비: 220px 기준).
  - 패널 위치: 토글 아래에 패널이 열리도록 조정하고, 뷰포트 범위를 초과할 경우 클램프하여 잘리지 않도록 했습니다.

- Category Mapping (쇼핑몰 카테고리 매핑)
  - 매핑 생성 플로우 추가: 내부 카테고리 + 쇼핑몰 카테고리 선택 → `매핑 생성` 버튼으로 매핑을 생성합니다.
  - 중복 방지: 동일한 내부카테고+쇼핑몰+쇼핑몰카테고 조합이 이미 활성 상태이면 생성 차단 및 알림 표시.
  - 매핑 상태 토글: 매핑별 활성/비활성 토글 및 삭제 기능 제공.
  - 엑스포트: 현재 선택 중인 쇼핑몰의 매핑을 엑셀 형식으로 내보내기 가능.

- 사이드바 및 네비게이션
  - 카테고리 매핑 메뉴 ID를 `category-mapping`으로 조정하여 SPA 내부 라우팅 정합성 확보.

- 스타일/레이아웃
  - 카드 중앙 구분선(시각적 중간 라인) 제거 및 전반적인 카드 패딩/그림자 미세 조정.
  - 모달 크기를 컨텍스트별로 조정하여 레이아웃 일관성 개선.

---

## 페이지별 상세 기능 목록
아래는 각 페이지(및 주요 컴포넌트)별 사용자 기능 및 개발자 참고사항입니다. 릴리스 노트/도움말로 그대로 사용 가능합니다.

### 공통 컴포넌트
- `HierarchicalSelect`
  - 포탈 렌더링(`document.body`)으로 모달 내부에서도 드롭다운이 잘림 없이 표시됩니다.
  - 각 뎁스는 고정 너비 컬럼(기본 220px)으로 가로 배치되어 2~3레벨 선택이 쉬워졌습니다.
  - 토글 아래에 패널이 열리며, 뷰포트 바운드 클램프가 적용됩니다.
  - 개발자 참고: 컬럼 너비(`colWidth`)와 최대 뎁스(`MAX_DEPTH`)는 컴포넌트 내부에서 조정 가능합니다.

### `/pages/settings/ProductClassificationsPage.tsx` (분류 편집)
- 기능
  - 계층형 분류 트리 CRUD(루트/자식 추가, 편집, 삭제)
  - 삭제 프리뷰 모달: 삭제 시 하위 노드 삭제 영향을 시각적으로 확인
  - 노드 선택 및 하이라이트
  - 접기/펼치기 애니메이션(`AnimatedCollapse`)
  - 분류 트리를 `localStorage`로 저장/로드
- 개발자 주의사항
  - 모달 크기(`modalClass`)는 액션에 따라 `max-w-3xl`/`max-w-2xl`/`max-w-xl`로 설정됩니다.
  - 액션 버튼은 이벤트 전파를 막기 위해 `e.stopPropagation()`을 사용합니다.

### `/pages/malls/CategoryMappingPage.tsx` (카테고리 매핑)
- 기능
  - 쇼핑몰 선택(활성/비활성 표기)
  - 내부 카테고리 검색 및 레벨 필터
  - 쇼핑몰 카테고리 리스트(선택 가능)
  - 매핑 생성(내부 카테고리 + 쇼핑몰 카테고리) — 중복 방지 로직 포함
  - 현재 매핑 현황 테이블(경로 표시, 활성/비활성 토글, 삭제)
  - 매핑 엑스포트(xlsx)
  - 통계: 내부 소분류 수, 활성 매핑 수, 매핑 완성도 비율
- 개발자 참고사항
  - 매핑은 현재 컴포넌트 상태(`useState`)로 관리됩니다. 실제 운영 스토리지/서버 연동 시 API 통신으로 전환 필요.

### `/pages/products/ProductsListPage.tsx` (상품 목록)
- 기능
  - 검색(상품명/코드), 분류 필터(`HierarchicalSelect`), 브랜드/상태 필터
  - 정렬 옵션(신규/이름/가격/재고 등)
  - 페이징(기본 페이지 사이즈 15)
  - 상품 선택 및 배치 액션(엑셀, 일괄 활성화/비활성화/삭제 — UI 상 플레이스홀더)
  - 옵션(variants) 인라인 펼침 보기
  - 엑스포트(필터된 데이터)
- 개발자 참고사항
  - `HierarchicalSelect`가 분류 필터에 적용되어 있어 드롭다운 포탈 동작을 확인하세요.

### `/pages/products/ProductDetailPage.tsx` (상품 상세)
- 기능
  - 상품 기본 정보(이미지, 이름, 코드, 브랜드, 공급사, 가격, 마진 등)
  - 옵션 테이블(바코드, 가격, 재고, 상태)
  - 상품 설정 모달, 상품 설명 편집 모달(현재는 로컬 상태 기반, 서버 저장 미구현)
- 개발자 참고사항
  - 모달 내 폼 저장 로직은 데모용으로 닫기 동작만 구현되어 있습니다.

### `/pages/orders/OrderListPage.tsx` (주문 관리)
- 기능
  - 주문 검색/필터/정렬(상태, 결제 수단, 날짜 범위 등)
  - 주문 통계 카드(상태별 집계)
  - CSV 내보내기
  - 주문 테이블(컴포넌트화됨) 및 페이지네이션
- 개발자 참고사항
  - `OrderTable`과 `OrderFilters` 컴포넌트와 연동되어 있으며, 필터/정렬 결과를 CSV로 내보내는 유틸을 사용합니다.

---

## QA 체크리스트 (권장)
아래는 배포 전/후 수동으로 확인해야 할 핵심 시나리오입니다. 각 항목별로 체크 후 서명(또는 이슈 등록)을 권장합니다.

1) 빌드
- `npm run build` 성공 여부 확인 (에러/경고 체크)

2) 기본 네비게이션
- 사이드바에서 각 페이지로 이동이 정상 동작하는지 확인

3) Product Classifications
- 루트 분류 추가 → 자식 추가 → 편집 → 삭제(삭제 미리보기 확인) 흐름 검증
- AnimatedCollapse 애니메이션이 중첩 트리에서 자연스럽게 동작하는지 확인
- 모달 크기(루트 추가/하위 추가/편집)가 의도한 대로 변화하는지 확인

4) HierarchicalSelect
- 모달 내부(예: 상품 목록 필터)에서 드롭다운이 잘리는지 확인하지 않음 (포탈 동작)
- 3레벨 이상(깊은 분류) 선택 시 각 뎁스가 가로 컬럼으로 잘 보이는지 확인
- 작은 화면에서 컬럼 오버플로우/스크롤 동작을 확인

5) Category Mapping
- 쇼핑몰 선택 → 내부 카테고리 선택 → 쇼핑몰 카테고리 선택 → 매핑 생성(중복 차단 메시지) 확인
- 매핑 활성/비활성 토글 및 삭제 검증
- 엑스포트 파일이 예상 포맷으로 생성되는지 확인

6) Products / Orders
- 필터/검색/정렬/페이징 기본 동작 확인
- 상품 옵션 펼침(variants) 동작 확인
- CSV/엑셀 내보내기 동작 확인

7) 브라우저 콘솔
- 개발자 콘솔에서 오류/경고가 없는지 확인

---

## 배포 단계 (권장 절차)
1. 로컬 빌드: `npm run build`
2. 정적 파일 점검: 빌드 산출물에서 주요 번들 및 이미지 확인
3. 테스트 서버에 배포(예: Vercel, Netlify 등) — 배포 설정에 따른 CI/CD 파이프라인 사용
4. 스테이징에서 수동 QA(위 QA 체크리스트)를 수행
5. 프로덕션 배포

---

## 기술적 메모 / 마이그레이션 포인트
- `CategoryMappingPage`의 매핑 데이터는 현재 로컬 상태(`useState`)로 유지됩니다. 실제 서비스화 시엔 백엔드 API와 동기화(CRUD 엔드포인트)가 필요합니다.
- `ProductClassificationsPage`의 분류 트리는 `localStorage`에 보관되므로, 서버 동기화 기능이 추가되면 로직을 확장해 주세요.
- `HierarchicalSelect`의 포탈/레이아웃 로직은 모달 내부에서도 안정적으로 동작하지만, 작은 뷰포트에서의 UX는 추가 튜닝(컬럼 축소, 오버플로우 전략)이 필요합니다.

---

## 변경 파일(요약)
- `src/pages/settings/ProductClassificationsPage.tsx` — AnimatedCollapse, 삭제 미리보기, modalClass, 노드 선택 등
- `src/components/common/HierarchicalSelect.tsx` — 포탈화, 가로 컬럼 레이아웃, 아래쪽 열림 및 뷰포트 클램프
- `src/pages/malls/CategoryMappingPage.tsx` — 매핑 생성/삭제/토글 UI
- `src/components/layout/Sidebar.tsx` — 카테고리 매핑 메뉴 ID 변경

---

작성: 자동 생성된 릴리스 노트 (요약/세부 포함)
문의가 있거나 릴리스 노트에 항목을 추가/수정하길 원하시면 알려주세요.
